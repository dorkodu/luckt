{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["function store<T1, T2>(state: T1, logic: T2) {\r\n  let watchers: { [key: string]: { id: number, cb: () => void }[] } = {};\r\n  let id = 0;\r\n\r\n  for (const key in logic) {\r\n    const cb: (...payload: any) => boolean = (logic[key] as any);\r\n    (logic[key] as any) = (...payload: any[]) => {\r\n      if (cb(...payload)) dispatch(key);\r\n    }\r\n  }\r\n\r\n  function dispatch(key: string) {\r\n    if (!watchers[key]) return;\r\n\r\n    for (let i = 0; i < watchers[key].length; ++i) {\r\n      watchers[key][i].cb();\r\n    }\r\n  }\r\n\r\n  function watch(key: keyof typeof logic, cb: () => void) {\r\n    const watchId = id++;\r\n\r\n    if (!watchers[key as string]) watchers[key as string] = [];\r\n    watchers[key as string].push({ id: watchId, cb: cb });\r\n\r\n    return () => { unwwatch(key as string, watchId) };\r\n  }\r\n\r\n  function unwwatch(key: string, id: number) {\r\n    for (let i = 0; i < watchers[key].length; ++i) {\r\n      if (watchers[key][i].id === id) {\r\n        watchers[key].splice(i, 1);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  return { state, logic, watch };\r\n}\r\n\r\nexport const luckt = { store };\r\n"],"names":[],"mappings":"AAAA,SAAS,KAAK,CAAS,KAAS,EAAE,KAAS;IACzC,IAAI,QAAQ,GAAwD,EAAE,CAAC;IACvE,IAAI,EAAE,GAAG,CAAC,CAAC;IAEX,KAAK,MAAM,GAAG,IAAI,KAAK,EAAE;QACvB,MAAM,EAAE,GAAkC,KAAK,CAAC,GAAG,CAAS,CAAC;QAC5D,KAAK,CAAC,GAAG,CAAS,GAAG,CAAC,GAAG,OAAc;YACtC,IAAI,EAAE,CAAC,GAAG,OAAO,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,CAAC;SACnC,CAAA;KACF;IAED,SAAS,QAAQ,CAAC,GAAW;QAC3B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;YAAE,OAAO;QAE3B,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YAC7C,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC;SACvB;KACF;IAED,SAAS,KAAK,CAAC,GAAuB,EAAE,EAAc;QACpD,MAAM,OAAO,GAAG,EAAE,EAAE,CAAC;QAErB,IAAI,CAAC,QAAQ,CAAC,GAAa,CAAC;YAAE,QAAQ,CAAC,GAAa,CAAC,GAAG,EAAE,CAAC;QAC3D,QAAQ,CAAC,GAAa,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,OAAO,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QAEtD,OAAO,QAAQ,QAAQ,CAAC,GAAa,EAAE,OAAO,CAAC,CAAA,EAAE,CAAC;KACnD;IAED,SAAS,QAAQ,CAAC,GAAW,EAAE,EAAU;QACvC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE;YAC7C,IAAI,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,EAAE;gBAC9B,QAAQ,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBAC3B,OAAO;aACR;SACF;KACF;IAED,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;AACjC,CAAC;MAEY,KAAK,GAAG,EAAE,KAAK;;;;"}